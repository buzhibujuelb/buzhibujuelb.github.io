---
title: æœæ•™ç­›ä¸è«æ¯”ä¹Œæ–¯åæ¼”
date: 2018-10-13 22:51:13
tags: 
  - æ•°å­¦
  - è«æ¯”ä¹Œæ–¯åæ¼”
mathjax: true
categories: æ€»ç»“

---

é¦–å…ˆæ˜¯æœæ•™ç­›å¥—è·¯å¼å­
$$
æ±‚\sum_{x=1}^n f(x)
$$

å…¶ä¸­nå¾ˆå¤§ä¸€èˆ¬$10^9 \sim 2^{32}â€‹$ å·¦å³å¯¼è‡´å¸¸è§„çº¿æ€§ç­›è¶…æ—¶

## ä¸€èˆ¬åšæ³•ï¼š

$$
ä»¤S(x)=\sum_{i=1}^{x}f(i)\\
$$
å†æ‰¾ä¸€å’Œ$f$å·ç§¯èµ·æ¥æœ‰ç‰¹æ®Šæ€§è´¨çš„å‡½æ•°$g(x)$

$$
\begin{align}
 \sum_{i=1}^{n}f*g(i) 
&=\sum_{i=1}^{n}\sum_{d|i}g(d)*f(\frac{i}{d})\\
&=\sum_{d=1}^{n}g(d)*\sum_{d|i}f(\frac{i}{d})\\
&=\sum_{d=1}^{n}g(d)*\sum_{i=1}^{n/d}f(i)\\
&=\sum_{d=1}^{n}g(d)*S(\frac{n}{d}) \\
&=\sum_{d=2}^{n}g(d)*S(\frac{n}{d})+g(1)*S(n)
\end{align}
$$

ç„¶åå°±å‘ç°å³è¾¹ç­‰å¼æœ€åä¸€é¡¹é™¤ä»¥$g(1)$æ˜¯è¦æ±‚çš„ç­”æ¡ˆ

è€Œ  $\displaystyle\sum_{d=2}^{n}g(d)*S(\frac{n}{d}) $  è¿™ç©æ„å¯ä»¥é€’å½’ä¸‹å»

 $\displaystyle\sum_{i=1}^n f*g(i)$ ä¸€èˆ¬ä¼šåœ¨æˆ‘ä»¬çš„é€‰æ‹©ä¸‹æ¯”è¾ƒå¥½ç®—

---
å…ˆæ˜¯ä¸€é“æ¨¡æ¿é¢˜


## [BZOJ3944](https://lydsy.com/JudgeOnline/problem.php?id=3944)

> ### Description
> ç»™å®šä¸€ä¸ªæ­£æ•´æ•°N(N<=$2^{31}-1$)æ±‚
> $ans1=\displaystyle\sum_{i=1}^{n} \phi(i) \quad\ ans2= \displaystyle\sum_{i=1}^n \mu(i)  $
> ### Input
> ä¸€å…±$T+1$è¡Œ
> ç¬¬$1$è¡Œä¸ºæ•°æ®ç»„æ•°$T(T<=10)$
> ç¬¬$2~T+1$è¡Œæ¯è¡Œä¸€ä¸ªéè´Ÿæ•´æ•°Nï¼Œä»£è¡¨ä¸€ç»„è¯¢é—®
> ### Output
> ä¸€å…±Tè¡Œï¼Œæ¯è¡Œä¸¤ä¸ªç”¨ç©ºæ ¼åˆ†éš”çš„æ•°ans1,ans2

å¯¹äºè¿™é“é¢˜å¯ä»¥çŸ¥é“
$$
\begin{align}
(\mu * 1)&=[x=1] \\
\phi*1&=x \\
ä»¤g(x)&=1 \\
å¯¹äº \mu\\
\sum_{i=1}^{n}f*g(i)&=1\\
æ‰€ä»¥S(n)&=1-\sum_{d=2}^{n}S(n/d)\\
å¯¹äº\phi \\
\sum_{i=1}^{n}f*g(i)&=1+2+\dots+n=\frac{n(n+1)}{2}\\
æ‰€ä»¥S(n)&=\frac{n(n+1)}{2}-\sum_{d=2}^{n}S(n/d)
\end{align}
$$
å…·ä½“å®ç°æˆ‘å°±ä½¿ç”¨mapäº†=.=

### Code

```c++
inline ll solve(int opt,unsigned x){
	if (x<MAXN)	return opt?sum1[x]:sum0[x];
	if (M[opt][x])	return M[opt][x];
	ll ret=opt?1ll:1ll*x*(x+1)>>1;
	for (unsigned i=2,j=2;i<=x;i=j+1){
		j=x/(x/i);
		ret-=solve(opt,x/i)*(j-i+1);
	}
	return M[opt][x]=ret;
}
```

å‚»é€¼é¢˜è®²å®Œäº†T.T

---
## [BZOJ3930](https://lydsy.com/JudgeOnline/problem.php?id=3930)

>### Description
>æˆ‘ä»¬çŸ¥é“ï¼Œä»åŒºé—´[L,H]ï¼ˆLå’ŒHä¸ºæ•´æ•°ï¼‰ä¸­é€‰å–Nä¸ªæ•´æ•°ï¼Œæ€»å…±æœ‰$(H-L+1)^N$ç§æ–¹æ¡ˆã€‚å°zå¾ˆå¥½å¥‡è¿™æ ·é€‰å‡ºçš„æ•°çš„æœ€å¤§å…¬çº¦æ•°çš„è§„å¾‹ï¼Œä»–å†³å®šå¯¹æ¯ç§æ–¹æ¡ˆé€‰å‡ºçš„Nä¸ªæ•´æ•°éƒ½æ±‚ä¸€æ¬¡æœ€å¤§å…¬çº¦æ•°ï¼Œä»¥ä¾¿è¿›ä¸€æ­¥ç ”ç©¶ã€‚ç„¶è€Œä»–å¾ˆå¿«å‘ç°å·¥ä½œé‡å¤ªå¤§äº†ï¼Œäºæ˜¯å‘ä½ å¯»æ±‚å¸®åŠ©ã€‚ä½ çš„ä»»åŠ¡å¾ˆç®€å•ï¼Œå°zä¼šå‘Šè¯‰ä½ ä¸€ä¸ªæ•´æ•°Kï¼Œä½ éœ€è¦å›ç­”ä»–æœ€å¤§å…¬çº¦æ•°åˆšå¥½ä¸ºKçš„é€‰å–æ–¹æ¡ˆæœ‰å¤šå°‘ä¸ªã€‚ç”±äºæ–¹æ¡ˆæ•°è¾ƒå¤§ï¼Œä½ åªéœ€è¦è¾“å‡ºå…¶é™¤ä»¥1000000007çš„ä½™æ•°å³å¯ã€‚
>### Input
> è¾“å…¥ä¸€è¡Œï¼ŒåŒ…å«4ä¸ªç©ºæ ¼åˆ†å¼€çš„æ­£æ•´æ•°ï¼Œä¾æ¬¡ä¸ºNï¼ŒKï¼ŒLå’ŒHã€‚
>### Output
>è¾“å‡ºä¸€ä¸ªæ•´æ•°ï¼Œä¸ºæ‰€æ±‚æ–¹æ¡ˆæ•°ã€‚
>
>### Sample Input
```
2 2 2 4
```
>### Sample Output
```
3
```
>### HINT
>æ ·ä¾‹è§£é‡Š
>æ‰€æœ‰å¯èƒ½çš„é€‰æ‹©æ–¹æ¡ˆï¼š(2, 2), (2, 3), (2, 4), (3, 2), (3, 3), (3, 4), (4, 2), (4, 3), (4, 4)
>å…¶ä¸­æœ€å¤§å…¬çº¦æ•°ç­‰äº2çš„åªæœ‰3ç»„ï¼š(2, 2), (2, 4), (4, 2)
>å¯¹äº100%çš„æ•°æ®ï¼Œ$1â‰¤N,Kâ‰¤10^9ï¼Œ1â‰¤Lâ‰¤Hâ‰¤10^9ï¼ŒH-Lâ‰¤10^5$

ä¸€çœ‹è¿™æ•°æ®èŒƒå›´å°±æ‡µé€¼äº†=.=

å…ˆ$L,Réƒ½é™¤ä»¥K$å°±å˜æˆæ±‚åŒºé—´$gcd=1$çš„æ–¹æ¡ˆäº†

ç„¶åçœ‹ä¸Šå»è¦æœæ•™ç­›ä¸è¿‡$R-L<=10^5â€‹$å¯ä»¥æšä¸¾é€‰çš„Nä¸ªæ•°çš„$ gcdâ€‹$

ä¸€å †å·®ä¸è¶…è¿‡$10^5 $çš„æ•°çš„$gcd$ä¹Ÿåœ¨$10^5$ä»¥å†…ï¼ˆæ˜“è¯ï¼‰

$$
ä»¤f(x)è¡¨ç¤ºgcdæ°å¥½ä¸ºxçš„æ–¹æ¡ˆæ•° \\
g(x)è¡¨ç¤ºgcdæ˜¯xçš„å€æ•°çš„æ–¹æ¡ˆæ•° å¯ä»¥O(1)æ±‚\\
\begin{align}
ç„¶åg(x)&=\sum_{x|d}f(d) \\
é€šè¿‡åæ¼”æ¨¡æ¿
f(x)&=\sum_{x|d}\mu(d)f(x/d)\\
å¾—f(1)&=\sum_{i=1}\mu(i)g(i)
\end{align}
$$

$g(x)$ æ€ä¹ˆæ±‚ï¼Ÿ

åŒºé—´ä»»é€‰$N$ä¸ªæ•°ä½¿å¾—éƒ½æ˜¯ä¸€ä¸ªæ•°$x$çš„å€æ•°=.=å¿«é€Ÿå¹‚ææ

å¹¶ä¸”é€‰çš„è¿™$N$ä¸ªæ•°ä¸èƒ½å…¨éƒ¨ä¸€æ ·

æ‰€ä»¥é€‰çš„æ–¹æ¡ˆè¦å‡å»è¿™ä¸ªåŒºé—´çš„æ•°çš„ä¸ªæ•°ï¼ˆåˆšå¥½è¿™ä¹ˆå¤šç§æ‰€æœ‰æ•°éƒ½ä¸€æ ·çš„æ–¹æ¡ˆï¼‰

è¿˜æœ‰ä¸ªç‰¹åˆ¤ä¸ºåŒºé—´æ˜¯å¦åŒ…å«1ï¼ŒåŒ…å«$1çš„è¯æœ‰1ç§å…¨éƒ¨éƒ½æ˜¯1$æ—¶çš„$gcdä¸º1$

### Code

```c++
inline int getf(int x){
	int lt=(L%x)?L/x+1:L/x,rt=R/x;
	return add(qpow(rt-lt+1,N),-rt+lt-1);
}
int main(){
	pre();
	read(N);read(K);read(L);read(R);
	L=L%K?L/K+1:L/K;R/=K;n=R-L;
	for (int i=1;i<=n;i++)
		ans=add(ans,mul(mu[i],getf(i)));
	if (L<=1 && 1<=R)	ans=add(ans,1);
}
```
---
## [BZOJ3529](https://lydsy.com/JudgeOnline/problem.php?id=3529)
>### Description
>æœ‰ä¸€å¼ $ nÃ—m$ çš„æ•°è¡¨ï¼Œå…¶ç¬¬ $i$ è¡Œç¬¬$ j$ åˆ—$ï¼ˆ1 <= i <= n, 1 <= j <= mï¼‰$çš„æ•°å€¼ä¸º
>èƒ½åŒæ—¶æ•´é™¤ $i$ å’Œ$ j$ çš„æ‰€æœ‰è‡ªç„¶æ•°ä¹‹å’Œã€‚ç»™å®š$ a$ , è®¡ç®—æ•°è¡¨ä¸­ä¸å¤§äº$ a$ çš„æ•°ä¹‹å’Œã€‚
>### Input
>è¾“å…¥åŒ…å«å¤šç»„æ•°æ®ã€‚
>è¾“å…¥çš„ç¬¬ä¸€è¡Œä¸€ä¸ªæ•´æ•°$Q$è¡¨ç¤ºæµ‹è¯•ç‚¹å†…çš„æ•°æ®ç»„æ•°
>æ¥ä¸‹æ¥$Q$è¡Œï¼Œæ¯è¡Œä¸‰ä¸ªæ•´æ•°$nï¼Œmï¼Œa(|a| < =10^9)$æè¿°ä¸€ç»„æ•°æ®ã€‚
>$1 < =Nï¼m < =10^5  ï¼Œ 1 < =Q < =2Ã—10^4$
>### Output
>å¯¹æ¯ç»„æ•°æ®ï¼Œè¾“å‡ºä¸€è¡Œä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºç­”æ¡ˆæ¨¡$2^31$çš„å€¼ã€‚
>
>### Sample Input
```
2
4 4 3
10 10 5
```
>### Sample Output
```
20
148
```

å¥½åƒå¾ˆéš¾æ=.=ä¸è¿‡1e5æ•°æ®èŒƒå›´å¯ä»¥ä¸ç”¨**æœæ•™ç­›** å¼å•Š

å†™æˆæ•°å­¦ç¬¦å·å°±æ˜¯


$$
ä»¤F(x)=\sum_{i|x}^{x}i\\
æ±‚\sum_{i=1}^{N}\sum_{j=1}^{M}[F(gcd(i,j)<=a]F(gcd(i,j))
$$
å•¥ç©æ„æ²¡å¬è¿‡==


### å…ˆè€ƒè™‘ç®€åŒ–ç‰ˆé—®é¢˜ï¼š**ä¸è€ƒè™‘açš„å½±å“**æ€ä¹ˆåš

é¦–å…ˆçº¦æ•°å’Œ$F(x)$å¯ä»¥çº¿æ€§ç­›é¢„å¤„ç†:

å‡è®¾$p$æ˜¯ä¸ªè´¨æ•°
$$
\begin{align}
F(p)&=p+1\\
F(x*p)&=F(x)*F(p)\quad(gcd(x,p)=1)\\
F(x*p)&=F(x)/(p^0+p^1+...p^n)*(p^0+p^1+...+p^{n+1})\quad (gcd(x,p)=p)\\
\end{align}
$$
éå¸¸å¥½ç„¶åæˆ‘ä»¬å¯ä»¥
$$
\begin{align}
ä»¤g(x)&=\sum_{i=1}^N\sum_{j=1}^{M}[gcd(i,j)=x]\\
&=\sum_{i=1}^{N/x}\sum_{j=1}^{M/x}[gcd(i,j)=1]\\
&=\sum_{i=1}^{N/x}\sum_{j=1}^{M/x}\sum_{d|gcd(i,j)}\mu(d)\\
&=\sum_{d=1}^{min(N/x,M/x)}\mu(d)*[\frac{N}{x*d}]*[\frac{M}{x*d}]\\
\end{align}
$$
ä»¤$k=x*d$
$$
g(x)=\sum_{k=x}^{min(N,M)}[\frac{N}{k}][\frac{M}{k}]\mu(\frac{k}{x})
$$




æ‰€ä»¥ç­”æ¡ˆå°±æ˜¯
$$
\sum_{i=1}^{min(N,M)}f(i)*g(i)\\
=\sum_{k=1}^{min(N,M)}[\frac{N}{k}][\frac{M}{k}]\sum_{x|k}\mu(x)*f(k/x)
$$
å°±å¯ä»¥ç”¨æ ¹å·åˆ†å—å’Œé¢„å¤„ç†å‰ç¼€å’Œæ°´äº†


### ç„¶åè€ƒè™‘æ€ä¹ˆåŠ å…¥açš„é™åˆ¶

emmm

N,Mæ‰$10^5$ï¼Œå¯ä»¥æŒ‰$F(x)$æ’åºå†å°†aæ’åºï¼ŒåŠ¨æ€ç»´æŠ¤ä¸‹å‰ç¼€å’Œå°±å¥½äº†

åŠ¨æ€ç»´æŠ¤å‰ç¼€å’Œçš„æ•°æ®ç»“æ„æ¯”å¦‚è¯´æ ‘çŠ¶æ•°ç»„

æ¨¡$2^{31}$å¯ä»¥~~è‡ªç„¶æº¢å‡º~~å’Œ$(1<<31)-1$å–ä¸

ç„¶åè¿™é¢˜å°±ç»“æŸäº†

### Code

```c++
inline void pre(){
	mu[1]=1;t[1]=1;F[1].xx=1;
	for (int i=2;i<=MAXN;i++){
		if (!vis[i])	prime[++cnt]=i,vis[i]=i,F[i].xx=i+1,t[i]=i+1,mu[i]=-1;
		for (int j=1;j<=cnt && i*prime[j]<=MAXN;j++){
			vis[i*prime[j]]=1;
			if (i%prime[j])	{
                	mu[i*prime[j]]=-mu[i];
                	F[i*prime[j]].xx=F[i].xx*1+prime[j]),t[i*prime[j]]=prime[j]+1;
            }else {
				mu[i*prime[j]]=0;
				t[i*prime[j]]=t[i]*prime[j]+1;
				F[i*prime[j]].xx=F[i].xx/t[i]*t[i*prime[j]];
				break;
			}
		}
	}
	for (int i=1;i<=MAXN;i++)	F[i].yy=i;
}
inline void fadd(int x){
	for (int i=1;i*F[x].yy<=MAXN;i++)
		add(i*F[x].yy,F[x].xx*mu[i]);
}
//è¿™é‡Œçœç•¥
sort(q+1,q+N+1);	sort(F+1,F+MAXN+1);
for (int i=1,j=0;i<=N;i++){
	while (j<MAXN&&F[j+1].xx<=q[i].a)	fadd(++j);	
	n=q[i].n;m=q[i].m;
	if (n>m)	swap(n,m);
	for (int l=1,r=1;l<=n;l=r+1){
		r=min(n/(n/l),m/(m/l));
		ans[q[i].id]+=(n/l)*(m/l)*(query(r)-query(l-1));
	}
}

```
---
## [BZOJ4652](https://lydsy.com/JudgeOnline/problem.php?id=4652)
>### Description
>ç‰›ç‰›æ˜¯ä¸€ä¸ªçƒ­çˆ±ç®—æ³•è®¾è®¡çš„é«˜ä¸­ç”Ÿã€‚åœ¨ä»–è®¾è®¡çš„ç®—æ³•ä¸­ï¼Œå¸¸å¸¸ä¼šä½¿ç”¨å¸¦å°æ•°çš„æ•°è¿›è¡Œè®¡ç®—ã€‚ç‰›ç‰›è®¤ä¸ºï¼Œå¦‚æœåœ¨$ k$ è¿›åˆ¶ä¸‹ï¼Œä¸€ä¸ªæ•°çš„å°æ•°éƒ¨åˆ†æ˜¯çº¯å¾ªç¯çš„ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯ç¾çš„ã€‚ç°åœ¨ï¼Œç‰›ç‰›æƒ³çŸ¥é“ï¼šå¯¹äºå·²çŸ¥çš„åè¿›åˆ¶æ•° $n$ å’Œ $m$ï¼Œåœ¨ k è¿›åˆ¶ä¸‹ï¼Œæœ‰å¤šå°‘ä¸ªæ•°å€¼ä¸Šäº’ä¸ç›¸ç­‰çš„çº¯å¾ªç¯å°æ•°ï¼Œå¯ä»¥ç”¨åˆ†æ•° $\displaystyle\frac{x}{y}$ è¡¨ç¤º,å…¶ä¸­ $1â‰¤xâ‰¤n,1â‰¤yâ‰¤m$ï¼Œä¸” $x,y$æ˜¯æ•´æ•°ã€‚ä¸€ä¸ªæ•°æ˜¯çº¯å¾ªç¯çš„ï¼Œå½“ä¸”ä»…å½“å…¶å¯ä»¥å†™æˆä»¥ä¸‹å½¢å¼ï¼š$a.\dot c_1c_2c_3â€¦c_{p-1}\dot c_p$å…¶ä¸­ï¼Œ$a$ æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œ$pâ‰¥1$ï¼›å¯¹äº $1â‰¤iâ‰¤p$ï¼Œ$ci$æ˜¯ $k$ è¿›åˆ¶ä¸‹çš„ä¸€ä½æ•°å­—ã€‚ä¾‹å¦‚ï¼Œåœ¨åè¿›åˆ¶ä¸‹ï¼Œ$0.45454545â€¦â€¦=0.\dot 4\dot 5$æ˜¯çº¯å¾ªç¯çš„ï¼Œå®ƒå¯ä»¥ç”¨ $\displaystyle\frac{5}{11},\displaystyle\frac{5}{22}$ ç­‰åˆ†æ•°è¡¨ç¤ºï¼›åœ¨åè¿›åˆ¶ä¸‹ï¼Œ$0.1666666â€¦â€¦=0.1\dot 6$åˆ™ä¸æ˜¯çº¯å¾ªç¯çš„ï¼Œå®ƒå¯ä»¥ç”¨ $\displaystyle\frac{1}{6}$ ç­‰åˆ†æ•°è¡¨ç¤ºã€‚éœ€è¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬è®¤ä¸ºä¸€ä¸ªæ•´æ•°æ˜¯çº¯å¾ªç¯çš„ï¼Œå› ä¸ºå®ƒçš„å°æ•°éƒ¨åˆ†å¯ä»¥è¡¨ç¤ºæˆ $0$ çš„å¾ªç¯æˆ–æ˜¯ $k-1$ çš„å¾ªç¯ï¼›è€Œä¸€ä¸ªå°æ•°éƒ¨åˆ†é $0$çš„æœ‰é™å°æ•°ä¸æ˜¯çº¯å¾ªç¯çš„ã€‚
>### Input
>åªæœ‰ä¸€è¡Œï¼ŒåŒ…å«ä¸‰ä¸ªåè¿›åˆ¶æ•°N,M,Kæ„ä¹‰å¦‚é¢˜æ‰€è¿°,ä¿è¯ $1â‰¤nâ‰¤10^9, 1â‰¤mâ‰¤10^9,2â‰¤kâ‰¤2000$
>### Output
>ä¸€è¡Œä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæ»¡è¶³æ¡ä»¶çš„ç¾çš„æ•°çš„ä¸ªæ•°ã€‚
>
>### Sample Input
```
2 6 10
```
>### Sample Output
```
4
```
> ### HINT
> æ»¡è¶³æ¡ä»¶çš„æ•°åˆ†åˆ«æ˜¯ï¼š
> 1/1=1.0000â€¦â€¦
> 1/3=0.3333â€¦â€¦
> 2/1=2.0000â€¦â€¦
> 2/3=0.6666â€¦â€¦
> 1/1 å’Œ 2/2 è™½ç„¶éƒ½æ˜¯çº¯å¾ªç¯å°æ•°ï¼Œä½†å› ä¸ºå®ƒä»¬ç›¸ç­‰ï¼Œå› æ­¤åªè®¡æ•°ä¸€æ¬¡ï¼›åŒæ ·ï¼Œ1/3 å’Œ 2/6 ä¹Ÿåªè®¡æ•°ä¸€æ¬¡ã€‚

å•¥ï¼Œçº¯å¾ªç¯å°æ•°ï¼Œæ²¡å¬è¿‡0.0

é¦–å…ˆè¿™é¢˜å¾ˆæ˜¾ç„¶å¯ä»¥çœ‹å‡ºæ˜¯è¦æ±‚ä¸€äº›åˆ†å­åˆ†æ¯äº’è´¨çš„æ•°çš„ä¸ªæ•°(ä¸äº’è´¨çš„ä¼šé‡å¤å‡ºç°)

å…ˆä¸ç®¡é‚£ä¹ˆå¤šå¼å­å†™èµ·æ¥
$$
\sum_{i=1}^{n}\sum_{j=1}^{m}[gcd(i,j)=1][åˆ†æ•°\frac{i}{j}åœ¨kè¿›åˆ¶ä¸‹çº¯å¾ªç¯]
$$
è¿˜æœ‰ä¸€ä¸ªå¯èƒ½æ˜¯å¯¹çš„ä¸ä¼šè¯å¾—å°±æ˜¯å¯¹äºä¸€ä¸ªçº¯å¾ªç¯å°æ•°$\displaystyle\frac ab$ å¦‚æœ$a\times c$ ä»ä¸åˆ†æ¯bäº’è´¨ï¼ˆä¸ç„¶å°±è¢«çº¦åˆ†æ¶ˆæ‰äº†ï¼‰ï¼Œé‚£ä¹ˆ$\displaystyle\frac {a\times c}b$åº”è¯¥ä»æ˜¯ä¸ªçº¯å¾ªç¯å°æ•°ï¼ˆå¯èƒ½æ˜¯é”™çš„æˆ‘ä¹Ÿä¸ä¼šè¯ï¼‰ï¼Œç„¶åå°±è¯´æ˜äº†æ˜¯å¦ä¸ºçº¯å¾ªç¯å°æ•°åœ¨åˆ†å­åˆ†æ¯äº’è´¨çš„æƒ…å†µä¸‹ä¸åˆ†å­å…³ç³»ä¸å¤§ï¼ˆè›¤ä¹Ÿä¸æ•¢è¯´æ˜¯ä¸æ˜¯å®Œå…¨æ²¡æœ‰å…³ç³»ï¼‰

è¿˜æ˜¯ä»¥$1$ä¸ºåˆ†å­åœ¨$10$è¿›åˆ¶ä¸‹~~æ‰¾æ‰¾è§„å¾‹~~æ‰“è¡¨


$$
\begin{align}
1/1&=1âœ”\\
1/2&=0.5âŒ\\
1/3&=0.\dot3âœ”\\
1/4&=0.25âŒ\\
1/5&=0.2âŒ\\
1/6&=0.1\dot6âŒ\\
1/7&=ğŸ¸ğŸ¸ğŸ¸=0.\dot14285\dot7âœ”\\
1/8&=0.125âŒ\\
1/9&=0.\dot1âœ”\\
1/10&=0.1âŒ\\
1/11&=0.\dot0\dot9âœ”\\
1/12&=0.08\dot3âŒ\\
...
\end{align}
$$
å°†ç¬¦åˆè¦æ±‚çš„åˆ†æ¯å†™ä¸‹æ¥$1,3,7,9,11$å—¯æ²¡æœ‰å¶æ•°ï¼Œä½†ä¹Ÿè·Ÿè´¨æ•°ä¸åƒï¼Œç„¶åé€šè¿‡ä¸¥è°¨è€Œåˆç»†è‡´çš„~~çŒœæµ‹~~æ¨ç†æˆ‘ä»¬å‘ç°è¿™ä¸œè¥¿åº”è¯¥æ˜¯è¦æ±‚åˆ†æ¯ä¸käº’è´¨

å…·ä½“ä¸ºä»€ä¹ˆ=.=

### è¯æ˜From ç¥ä»™ç½‘å‹

æˆ‘ä»¬å…ˆæ¥å›æƒ³ä¸€ä¸‹ï¼Œæˆ‘ä»¬æ˜¯æ€æ ·ä½¿ç”¨é™¤æ³•æ¥åˆ¤æ–­ä¸€ä¸ªåˆ†æ•°$ \displaystyle\frac xy$æ˜¯å¦æ˜¯çº¯å¾ªç¯å°æ•°çš„ã€‚æ˜¾ç„¶æˆ‘ä»¬æ˜¯ä¸€è·¯é™¤ä¸‹å»ï¼Œä»€ä¹ˆæ—¶å€™å‡ºç°äº†ç›¸åŒçš„ä½™æ•°ï¼Œé‚£ä¹ˆè¿™ä¸ªæ•°å°±æ˜¯ä¸€ä¸ªå¾ªç¯å°æ•°ã€‚å¦‚æœç¬¬ä¸€ä¸ªé‡å¤çš„ä½™æ•°æ˜¯$x$ï¼Œé‚£ä¹ˆè¿™ä¸ªæ•°å°±æ˜¯çº¯å¾ªç¯å°æ•°ã€‚è¿™ç§æ–¹æ³•å®é™…ä¸Šå°±æ˜¯å­˜åœ¨ä¸€ä¸ªæ•°$lâ‰ 0$ï¼Œä½¿å¾—ï¼š
$$
xk^l \equiv x (\bmod y)
$$
ã€€åˆç”±äºé¢˜ç›®è¦æ±‚å€¼ä¸é‡å¤ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å¾—åˆ°$xâŠ¥y$ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥æ¨å‡º$k^lâ‰¡1 \pmod y\quad (l>0)$ã€‚æ‰€ä»¥æˆ‘ä»¬åªéœ€$kâŠ¥y$å³å¯ã€‚

### æ‰€ä»¥äº‹æƒ…å˜æˆäº†æˆ‘ä»¬ç†Ÿæ‚‰çš„æ ·å­

$$
æ±‚\sum_{i=1}^{n}\sum_{j=1}^{m}[gcd(i,j)=1][gcd(j,k)=1]
$$

ç„¶åå¼€å§‹ä¹±æ
$$
\begin{align}
&\quad \quad\sum_{i=1}^{n}\sum_{j=1}^{m}[gcd(i,j)=1][gcd(j,k)=1]\\
&=\sum_{j=1}^{m}[gcd(j,k)=1]\sum_{i=1}^{n}[gcd(i,j)=1]\\
&=\sum_{j=1}^{m}[gcd(j,k)=1]\sum_{i=1}^{n}\sum_{d|gcd(i,j)}\mu(d)\\
&=\sum_{d=1}^{n}[gcd(d,k)=1]\mu(d)\sum_{j=1}^{m/d}\sum_{i=1}^{n/d}[gcd(j,k)=1]\\
&=\sum_{d=1}^{n}[gcd(d,k)=1]\mu(d)[\frac nd]\sum_{j=1}^{m/d}[gcd(j,k)=1]
\end{align}
$$
å¥½å•Šç„¶åå‘ç°è¿™ä¸ªä¸œè¥¿æ€ä¹ˆçœ‹æ€ä¹ˆä¸å¥½ç®—ï¼Œ$d,k$é•¿å¾—å¾ˆåƒä½†åˆå¤šäº†ä¸ª$\mu$æ‰€ä»¥ä¸èƒ½ç›´æ¥åˆå¹¶

æ‰€ä»¥~~å¼€å§‹æ‰“æš´åŠ›~~å¯èƒ½éœ€è¦åˆ†åˆ«è®¡ç®—
$$
\begin{align}
f(x)&=\sum_{i=1}^{x}[gcd(i,k)=1]\\
g(x,k)&=\sum_{i=1}^{x}[gcd(i,k)=1]\mu(i)è¿™é‡ŒæŠŠkè®°ä¸Šæ˜¯ä¸€ä¼šæœ‰ç”¨\\
\end{align}
$$
å¯¹äºä¸Šé¢é‚£ä¸ªä¸œè¥¿ç”±ä¸Šä¸Šé“é¢˜ç±»ä¼¼çš„æƒ³æ³•å‘ç°$gcd(k,x)<=k$ å¦‚æœ$iâŠ¥,k$é‚£ä¹ˆæ‰€æœ‰çš„$i+k,i+2k,i+3k...$éƒ½ä¸$k$äº’è´¨

æ‰€ä»¥åªéœ€é¢„å¤„ç†$1-k$çš„æ•°ä¸­æ¯ä¸ªæ•°ä¸käº’è´¨çš„æ•°çš„ä¸ªæ•°çš„å‰ç¼€å’Œï¼ˆç‰¹åˆ«æ³¨æ„è¿™ç©æ„ä¸æ˜¯$\phi$ï¼Œ å› ä¸º$\phi(x)$è¡¨ç¤ºå°äºç­‰äº$x$çš„æ•°ä¸­ä¸$x$äº’è´¨çš„æ•°ä¸ªæ•°è€Œä¸æ˜¯ä¸$k$äº’è´¨çš„æ•°çš„ä¸ªæ•°ï¼‰ä¹˜ä¸Š$x/k$ï¼Œå¯¹äº$x$å‰©ä¸‹çš„ä¸æ»¡$k$çš„å†å•ç‹¬è®¡ç®—å³å¯ã€‚ä»£ç å…¶å®å°±ä¸€å¥` int f(int x){return (x/K)*F[K]+F[x%K];}`

$f(x)$è¿™ä¹ˆç®€å•æå®šäº†ï¼Œé‚£ä¹ˆ$g(x) $èƒ½å¦åŒç†å‘¢ï¼Ÿ

~~å¦‚æœæ˜¯è¿™æ ·è¿™é¢˜å°±ä¸ä¼šæ˜¯æœ€åä¸€é“äº†~~

å¾ˆç®€å•çš„ä¾‹å­æ¯”å¦‚$gcd(i,k)=1$é‚£ä¹ˆ$gcd(i+k,k)=1$ä½†$mu(i+k)$ä¸ä¸€å®šç­‰äº$\mu(i)$ 

äºæ˜¯å¼€å§‹ç¡¬åˆš
$$
\begin{align}
g(x,k)&=\sum_{i=1}^{x}[gcd(i,k)=1]\mu(i)\\
&=\sum_{i=1}^{x}\mu(i)\sum_{d|gcd(i,k)}\mu(d)\\
&=\sum_{d|k}^{x}\mu(d)\sum_{i|d}\mu(i)\\
&=\sum_{d|k}^{x}\mu(d)\sum_{p=1}^{x/d}\mu(p*d)\\
\end{align}
$$
ç„¶åå‘ç°å½“$gcd(p,d)!=1$æ—¶$\mu$ä¸º$0$å¯¹ç­”æ¡ˆæ²¡æœ‰è´¡çŒ®ï¼Œæ‰€ä»¥è€ƒè™‘$gcd(p,d)=1$æ—¶
$$
\begin{align}
g(x,k)&=\sum_{d|k}^{x}\mu^2(d)\sum_{p=1}^{x/d}\mu(p)[gcd(p,d)=1]\\
&=\sum_{d|k}^x*1*\sum_{p=1}^{x/d}\mu(p)[gcd(p,d)=1]\\
&=\sum_{d|k}^x\sum_{p=1}^{x/d}\mu(p)[gcd(p,d)=1]
\end{align}
$$
çªç„¶å‘ç°è¿™å¼å­ä¼¼æ›¾ç›¸è¯†ã€‚ã€‚ã€‚

> $g(x,k)=\sum_{i=1}^{x}\mu(i)[gcd(i,k)=1]$

ï¼ï¼ï¼

æ‰€ä»¥å¾—åˆ°
$$
g(x,k)=\sum_{d|k}^x g(\frac nd,d)
$$
å¯¹äºk=1æ—¶æ‰¾åˆ°æœ€å¼€å§‹çš„å®šä¹‰
$$
\begin{align}g(x,1)&=\sum_{i=1}^{x}[gcd(i,1)=1]\mu(i)æ’æˆç«‹\\
&=\sum_{i=1}^x\mu(i)
\end{align}
$$
æ˜¯æˆ‘ä»¬æœ€å¼€å§‹è®²çš„ç¬¬ä¸€é“=.=ç„¶åå°±å®Œäº†

ç„¶ååˆå˜æˆç®€å•é€’å½’é¢˜äº†ï¼Œå¤æ‚åº¦$=O(èƒ½è¿‡)$

### Code

```c++
map<pii,int>MA;
inline int f(int x){return (x/K)*F[K]+F[x%K];}
inline int g(int x,int k){//æ¯”ä¸€èˆ¬æœæ•™ç­›å¤šäº†ä¸ªå‚æ•°0.0
	if ((k==1 && x<MAXN)|| !x)	return sum[x];
	if (MA[pii(x,k)])	return MA[pii(x,k)];
	int ret=0;
	if (k==1){
		ret++;
		for (int i=2,j=2;i<=x;i=j+1){
			j=x/(x/i);
			ret-=(j-i+1)*g(x/i,1);
		}
	}else{
		for (int i=1;i*i<=k;i++)	if (!(k%i)){//è¿™é‡Œä¹Ÿåªç”¨æšä¸¾åˆ°sqrt(k)ï¼Œå› ä¸ºå› æ•°æ˜¯æˆå¯¹çš„
			if (mu[i])ret+=g(x/i,i);			//è¿™é‡Œé˜²æ­¢mu[i]ç­‰äº0ç™½ç®—ä¸€å †
			if (mu[k/i] && (i*i^k))	ret+=g(x/(k/i),k/i);//i*iï¼=kæ‰å†ç®—ä¸ç„¶è´¡çŒ®ç®—ä¸¤é
		}
	}
	return MA[pii(x,k)]=ret;
}
//è¿™é‡Œè¿˜æ˜¯çœç•¥é˜²æ­¢ctrl+c
	pre();
	n=min(N,M);
	for (int i=1,j=1;i<=n;i=j+1){
		j=min(N/(N/i),M/(M/i));
		cur=S(j,K);
		ans+=(ll)(cur-lst)*f(M/i)*(N/i);
		lst=cur;
	}
```
---
## æ€»ç»“
æœæ•™ç­›æ˜¯çœ‹ä¸Šå»å¾ˆéš¾å®é™…ä¸Šä¹Ÿæ²¡é‚£ä¹ˆéš¾çš„ä¸œè¥¿ï¼Œå¸Œæœ›ä»Šå¤©å¤§å®¶éƒ½å¬æ‡‚äº†=.=
